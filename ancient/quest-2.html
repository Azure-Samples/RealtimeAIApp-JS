<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Scrolls of Divine Personas - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "tk53e05gf2");
    </script>
    
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/RealtimeAIApp-JS" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Temple of Echoes: Ancient Wisdom Unveiled</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Adventure</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: The Scrolls of Divine Personas</h1>
<hr>
<p>Deep within the Temple of Echoes lies the Hall of Personas, where ancient priests once communed with divine archetypes to guide their civilizations. Here, sacred scrolls describe the personalities of celestial beings and their roles in shaping mortal affairs. These scrolls encode the rules and rituals for invoking divine wisdom, including the structure of sacred messages and the tools used to decipher them. Your journey unveils the secrets of these personas, learning how their characteristics connect to the temple‚Äôs Whispering Glyphs and Ritual Stones.</p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:</p>
<ul>
<li>üéØ <strong>AI Personality Configuration</strong>: How system messages define distinct personas and guide their behavior in real-time interactions.</li>
<li>üîç <strong>JSON Schema Design</strong>: How structured schemas ensure consistent data representation across different divine tools.</li>
<li>‚ö° <strong>TypeScript Definitions</strong>: How strongly typed structures improve reliability and maintainability in complex systems.</li>
<li>üí° <strong>Tool Invocation Patterns</strong>: How function calls integrate AI responses with structured data outputs.</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/RealtimeAIApp-JS/blob/main/server/src/types.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">server/src/types.ts</code></a></h3>
<p>This file serves as the blueprint for the sacred glyphs that define the structure of communication within the Temple of Echoes. It contains TypeScript definitions for WebSocket message types, system messages, audio metrics, and error handling. These definitions ensure that the temple‚Äôs glyphs are interpreted consistently, providing a foundation for interactions between the mortal realm and divine personas.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">WSMessage</code> defines the structure of communication glyphs, ensuring clarity in message types (e.g., text_delta, transcription, control).</li>
<li><code class="inline-code">SystemMessage</code> describes the characteristics of divine personas, including their type, instructions, and associated tools.</li>
<li><code class="inline-code">AudioMetrics</code> tracks the performance of rituals, such as latency and data transfer statistics, ensuring smooth connections to the divine.</li>
<li><code class="inline-code">OpenAIError</code> outlines the structure of error glyphs, providing details for troubleshooting failed invocations.</li>
<li><code class="inline-code">RateLimits</code> specifies constraints on divine interactions, ensuring sustainable use of the temple‚Äôs wisdom.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">export type WSMessage =
    | { id: string; type: &#39;text_delta&#39;; delta: string }
    | { id?: string; type: &#39;transcription&#39;; text: string }
    | { id: string; type: &#39;user_message&#39;; text: string }
    | { type: &#39;control&#39;; action: &#39;speech_started&#39; | &#39;connected&#39; | &#39;text_done&#39; | &#39;function_call_output&#39;; functionCallParams?: string; id?: string }
    | { type: &#39;control&#39;; action: &#39;session_created&#39;; id?: string }
    | { type: &#39;control&#39;; action: &#39;error&#39;; error: OpenAIError; id?: string }
    | { type: &#39;control&#39;; action: &#39;rate_limits_updated&#39;; rateLimits: RateLimits; id?: string };
</code></pre>
<ul>
<li>Defines the structure of sacred glyphs for WebSocket communication, ensuring clarity in message types.</li>
<li>Enables precise categorization of messages, such as user input and divine responses, for seamless interaction.</li>
<li>Supports error handling and rate limit updates, ensuring stability during rituals.</li>
<li>The union type ensures flexibility while maintaining strict type safety.</li>
<li>Facilitates integration between client and server with clearly defined message protocols.</li>
</ul>
<hr>
<pre><code class="language-typescript">export type SystemMessage = {
    type: &#39;language-coach&#39; | &#39;medical-form&#39; | &#39;medical-question-answer&#39;;
    initialInstructions: string;
    message: string;
    tools?: SystemMessageTool[];
}
</code></pre>
<ul>
<li>Encodes the personas of divine archetypes, defining their unique roles and behaviors.</li>
<li>Includes initial instructions for greeting mortals and guiding their interactions.</li>
<li>Supports tool invocation, linking divine wisdom to structured outputs.</li>
<li>Enables modularity by allowing different personas to share common attributes while retaining unique characteristics.</li>
<li>Provides a foundation for expanding the temple‚Äôs library of personas.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/RealtimeAIApp-JS/blob/main/server/src/systemMessages.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">server/src/systemMessages.ts</code></a></h3>
<p>This file is the repository of divine scrolls, containing the detailed instructions for invoking and interacting with celestial personas. It defines system messages for the language coach, medical form assistant, and medical Q&amp;A assistant, along with their associated tools and schemas. These scrolls ensure that rituals are performed consistently, allowing mortals to access divine wisdom.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">systemMessages</code> stores the sacred scrolls for defining AI personas and their instructions.</li>
<li><a href="https://github.com/danwahlin/RealtimeAIApp-JS/blob/main/server/src/systemMessages.ts#L90" target="_blank" rel="noopener noreferrer"><code class="inline-code">getSystemMessage</code></a> retrieves a specific persona based on its type, ensuring targeted invocation.</li>
<li><a href="https://github.com/danwahlin/RealtimeAIApp-JS/blob/main/server/src/systemMessages.ts#L95" target="_blank" rel="noopener noreferrer"><code class="inline-code">getMedicalJSONSchema</code></a> defines the structure of medical data, ensuring consistent representation of patient information and symptoms.</li>
<li>Tool definitions link personas to their divine artifacts, enabling function calls for structured outputs.</li>
<li>Modular design allows easy addition of new personas and tools to the temple‚Äôs repository.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">const systemMessages: SystemMessage[] = [
    {
        type: &#39;language-coach&#39;,
        initialInstructions: `Greet the user warmly and ask what language they&#39;d like to learn today. Keep it very brief and friendly.`,
        message: `You are a helpful language coach that is capable of teaching students different phrases in their chosen language. You will 
            provide sentences in English, followed by the same sentence in the user&#39;s chosen language.
            RULES:
            - After the student tells you their chosen language, you will then read sentences in
            English followed by reading the same sentence in the user&#39;s chosen language...
            `,
        tools: []
    },
    {
        type: &#39;medical-form&#39;,
        initialInstructions: `Greet the medical personnel warmly and ask them to provide their patient information. Keep it very brief - 1 sentence only.`,
        message: `You are helping to edit a JSON object we&#39;ll refer to as &quot;patientData&quot; that represents a medical patient&#39;s personal information, symptoms, and vitals.
            This JSON object conforms to the following schema: 
            ${getMedicalJSONSchema()}
            RULES:
            - If the user says &quot;patient&quot;, return a value of &quot;patient&quot; for the &quot;tab&quot; property...
            `,
        tools: [{
            type: &#39;function&#39;,
            name: &#39;get_json_object&#39;,
            description: &#39;Converts text into a JSON object based upon a JSON schema&#39;,
            parameters: getMedicalJSONSchema()
        }]
    }
];
</code></pre>
<ul>
<li>Encodes detailed instructions for each persona, ensuring consistent behavior during rituals.</li>
<li>Includes schema definitions for structured data, enabling seamless integration with divine tools.</li>
<li>Modular design allows easy customization and expansion of personas and their rules.</li>
<li>Tool definitions link personas to their artifacts, enabling structured outputs for complex interactions.</li>
<li>Provides a foundation for invoking and interacting with diverse personas.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getSystemMessage(type: string): SystemMessage | null {
    const systemMessage = systemMessages.find((systemMessage) =&gt; systemMessage.type === type);
    return systemMessage || null;
}
</code></pre>
<ul>
<li>Retrieves the sacred scroll for a specific persona based on its type.</li>
<li>Ensures targeted invocation of personas, enabling precise interactions.</li>
<li>Simplifies integration by providing a single entry point for accessing persona configurations.</li>
<li>Modular design supports easy addition of new personas to the repository.</li>
<li>Facilitates dynamic invocation of personas based on user requirements.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Study how <code class="inline-code">SystemMessage</code> structures define the behavior and tools for each persona.</li>
<li>Observe how <code class="inline-code">WSMessage</code> enables seamless communication between the client and server.</li>
<li>Explore the modular design of <code class="inline-code">systemMessages</code> to understand how new personas can be added.</li>
</ul>
<h2>Try This</h2>
<p>Challenge yourself to deepen your understanding:</p>
<ol>
<li><p><strong>Create a New Persona</strong>: Define a new system message type, such as &quot;historian&quot;, and add rules for summarizing historical events. Include a tool for generating structured timelines.</p>
<ul>
<li>Example: <code class="inline-code">&quot;You are a historian capable of summarizing historical events and generating timelines.&quot;</code></li>
</ul>
</li>
<li><p><strong>Trace Message Flow</strong>: Add logging statements to <a href="https://github.com/danwahlin/RealtimeAIApp-JS/blob/main/server/src/systemMessages.ts#L90" target="_blank" rel="noopener noreferrer"><code class="inline-code">getSystemMessage</code></a> and <code class="inline-code">WSMessage</code> handling functions. Observe how messages are constructed and routed during interactions.</p>
</li>
<li><p><strong>Experiment with JSON Schema</strong>: Modify the <a href="https://github.com/danwahlin/RealtimeAIApp-JS/blob/main/server/src/systemMessages.ts#L95" target="_blank" rel="noopener noreferrer"><code class="inline-code">getMedicalJSONSchema</code></a> function to include additional properties, such as allergies or medications. Test how the system handles the updated schema.</p>
</li>
</ol>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the temple‚Äôs sacred technologies.</p>
<p>By the sacred flame of enlightenment, thou hast unveiled the first of five celestial scrolls, etching thy name among the annals of wisdom&#39;s eternal temple‚Äîpress onward, seeker of divine truths! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-1.html" class="prev-quest-btn">‚Üê Previous: Quest 1</a>
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>