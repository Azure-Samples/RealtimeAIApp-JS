<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Personality Core - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "tk53e05gf2");
    </script>
    
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-space">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/RealtimeAIApp-JS" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Galactic AI Navigator</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Adventure</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: AI Personality Core</h1>
<hr>
<p>The <em>Galactic Navigator</em> ventures deeper into the cosmic frontier, where the AI Personality Core powers the ship&#39;s ability to interact with alien languages and decipher stellar signals. This advanced system dynamically adjusts its behavior based on mission requirements, whether it&#39;s teaching a new language or gathering medical data. As the navigator, your task is to explore the AI Personality Core&#39;s internal mechanisms, ensuring that its system messages and tools are configured to support the crew&#39;s interstellar objectives.</p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:</p>
<ul>
<li>üéØ <strong>Dynamic AI Personalities</strong>: How system messages are tailored for different mission types like language coaching and medical assistance.</li>
<li>üîç <strong>JSON Schema Integration</strong>: How JSON schemas are used to structure and validate data for AI tools.</li>
<li>‚ö° <strong>WebSocket Message Protocol</strong>: The significance of message types in managing real-time communication between client and server.</li>
<li>üí° <strong>Tooling and Extensibility</strong>: How modular tools can be added to expand AI capabilities.</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/RealtimeAIApp-JS/blob/main/server/src/systemMessages.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">server/src/systemMessages.ts</code></a></h3>
<p>The AI Personality Core in this file defines the system messages that govern the behavior of the AI for different mission types. Each personality is configured with specific instructions and tools to handle unique tasks, such as language coaching or medical form assistance. The file also includes helper functions like <a href="https://github.com/danwahlin/RealtimeAIApp-JS/blob/main/server/src/systemMessages.ts#L90" target="_blank" rel="noopener noreferrer"><code class="inline-code">getSystemMessage</code></a> to retrieve configurations dynamically and <a href="https://github.com/danwahlin/RealtimeAIApp-JS/blob/main/server/src/systemMessages.ts#L95" target="_blank" rel="noopener noreferrer"><code class="inline-code">getMedicalJSONSchema</code></a> to define the structure of medical data.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">systemMessages</code>: Defines AI personalities with tailored instructions and tools for specific use cases.</li>
<li><a href="https://github.com/danwahlin/RealtimeAIApp-JS/blob/main/server/src/systemMessages.ts#L90" target="_blank" rel="noopener noreferrer"><code class="inline-code">getSystemMessage</code></a>: Retrieves the appropriate system message configuration based on the mission type.</li>
<li><a href="https://github.com/danwahlin/RealtimeAIApp-JS/blob/main/server/src/systemMessages.ts#L95" target="_blank" rel="noopener noreferrer"><code class="inline-code">getMedicalJSONSchema</code></a>: Provides a structured schema for medical data, ensuring consistent JSON formatting.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">const systemMessages: SystemMessage[] = [
    {
        type: &#39;language-coach&#39;,
        initialInstructions: `Greet the user warmly and ask what language they&#39;d like to learn today. Keep it very brief and friendly.`,
        message: `You are a helpful language coach...`,
        tools: []
    },
    {
        type: &#39;medical-form&#39;,
        initialInstructions: `Greet the medical personnel warmly and ask them to provide their patient information.`,
        message: `You are helping to edit a JSON object...`,
        tools: [{
            type: &#39;function&#39;,
            name: &#39;get_json_object&#39;,
            description: &#39;Converts text into a JSON object based upon a JSON schema&#39;,
            parameters: getMedicalJSONSchema()
        }]
    },
    {
        type: &#39;medical-question-answer&#39;,
        initialInstructions: `Greet the medical personnel warmly and ask them what their question is.`,
        message: `You&#39;re a medical question and answer assistant capable of answering questions...`,
    }
];
</code></pre>
<ul>
<li>Defines three distinct AI personalities: language coach, medical form assistant, and medical Q&amp;A.</li>
<li>Each personality includes tailored instructions and optional tools for specific tasks.</li>
<li>The modular structure allows for easy addition of new personalities or tools.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getSystemMessage(type: string): SystemMessage | null {
    const systemMessage = systemMessages.find((systemMessage) =&gt; systemMessage.type === type);
    return systemMessage || null;
}
</code></pre>
<ul>
<li>Dynamically retrieves the system message based on the mission type.</li>
<li>Ensures AI behavior is contextually appropriate for the task at hand.</li>
<li>Simplifies configuration management by centralizing personality definitions.</li>
</ul>
<hr>
<pre><code class="language-typescript">function getMedicalJSONSchema() {
    return {
        type: &#39;object&#39;,
        properties: {
            tab: { type: &#39;string&#39;, enum: [&#39;patient&#39;, &#39;symptoms&#39;, &#39;vitals&#39;] },
            information: {
                type: &#39;object&#39;,
                properties: {
                    name: { type: &#39;string&#39; },
                    age: { type: &#39;string&#39; },
                    gender: { type: &#39;string&#39;, enum: [&#39;male&#39;, &#39;female&#39;] },
                    historyPastMedical: { type: &#39;string&#39; },
                    historyOfPresentIllness: { type: &#39;string&#39; }
                },
                required: [&#39;name&#39;, &#39;age&#39;, &#39;gender&#39;]
            },
            symptoms: {
                type: &#39;array&#39;, items: {
                    type: &#39;object&#39;,
                    properties: {
                        id: { type: &#39;number&#39; },
                        description: { type: &#39;string&#39; },
                        duration: { type: &#39;string&#39; },
                        severity: { type: &#39;number&#39; }
                    },
                    required: [&#39;id&#39;, &#39;description&#39;, &#39;duration&#39;, &#39;severity&#39;]
                }
            },
            vitals: {
                type: &#39;object&#39;,
                properties: {
                    temperature: { type: &#39;number&#39; },
                    bloodPressure: { type: &#39;string&#39; },
                    heartRate: { type: &#39;number&#39; }
                },
                required: [&#39;temperature&#39;, &#39;bloodPressure&#39;, &#39;heartRate&#39;]
            }
        },
        required: [&#39;tab&#39;, &#39;information&#39;, &#39;symptoms&#39;, &#39;vitals&#39;]
    };
}
</code></pre>
<ul>
<li>Defines a comprehensive JSON schema for medical data.</li>
<li>Ensures data consistency and validates input against predefined formats.</li>
<li>Facilitates structured data exchange between the AI and external systems.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/RealtimeAIApp-JS/blob/main/server/src/types.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">server/src/types.ts</code></a></h3>
<p>This file provides TypeScript type definitions for WebSocket messages, system messages, and other key components. These types are critical for maintaining robust communication and ensuring data integrity across the AI Personality Core.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">WSMessage</code>: Enumerates WebSocket message types for real-time communication.</li>
<li><code class="inline-code">SystemMessage</code>: Defines the structure of AI personality configurations.</li>
<li><code class="inline-code">AudioMetrics</code>: Tracks performance metrics for audio data processing.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">export type WSMessage =
    | { id: string; type: &#39;text_delta&#39;; delta: string }
    | { id?: string; type: &#39;transcription&#39;; text: string }
    | { id: string; type: &#39;user_message&#39;; text: string }
    | { type: &#39;control&#39;; action: &#39;speech_started&#39; | &#39;connected&#39; | &#39;text_done&#39; | &#39;function_call_output&#39;; functionCallParams?: string; id?: string }
    | { type: &#39;control&#39;; action: &#39;session_created&#39;; id?: string }
    | { type: &#39;control&#39;; action: &#39;error&#39;; error: OpenAIError; id?: string }
    | { type: &#39;control&#39;; action: &#39;rate_limits_updated&#39;; rateLimits: RateLimits; id?: string };
</code></pre>
<ul>
<li>Enumerates all possible WebSocket message types for client-server communication.</li>
<li>Provides clear definitions for control actions like <code class="inline-code">speech_started</code> and <code class="inline-code">session_created</code>.</li>
<li>Ensures type safety in real-time messaging.</li>
</ul>
<hr>
<pre><code class="language-typescript">export type SystemMessage = {
    type: &#39;language-coach&#39; | &#39;medical-form&#39; | &#39;medical-question-answer&#39;;
    initialInstructions: string;
    message: string;
    tools?: SystemMessageTool[];
};
</code></pre>
<ul>
<li>Defines the structure of system messages, including type, instructions, and tools.</li>
<li>Supports extensibility by allowing optional tools to be added dynamically.</li>
<li>Centralizes AI personality configuration for easier maintenance.</li>
</ul>
<hr>
<pre><code class="language-typescript">export type AudioMetrics = {
    totalBytesSent: number;
    totalBatchesSent: number;
    maxBatchSize: number;
    lastSendTime: number;
    droppedChunks: number;
    avgLatency: number;
    lastResponseTime: number;
    sessionStartTime: number;
    totalResponses: number;
};
</code></pre>
<ul>
<li>Tracks audio processing metrics to monitor performance and identify bottlenecks.</li>
<li>Provides insights into data flow efficiency, latency, and response rates.</li>
<li>Enables proactive optimization of audio streaming pipelines.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Study how <code class="inline-code">systemMessages</code> centralizes AI personality definitions to simplify configuration changes.</li>
<li>Observe how <a href="https://github.com/danwahlin/RealtimeAIApp-JS/blob/main/server/src/systemMessages.ts#L95" target="_blank" rel="noopener noreferrer"><code class="inline-code">getMedicalJSONSchema</code></a> ensures data consistency through structured validation.</li>
<li>Explore <code class="inline-code">WSMessage</code> to understand the role of message types in real-time communication.</li>
</ul>
<h2>Try This</h2>
<p>Challenge yourself to deepen your understanding:</p>
<ol>
<li><p><strong>Add a New AI Personality</strong>: Create a new system message type for an alien language translator. Define instructions and tools for translating phrases between English and an alien dialect. Test its integration with <a href="https://github.com/danwahlin/RealtimeAIApp-JS/blob/main/server/src/systemMessages.ts#L90" target="_blank" rel="noopener noreferrer"><code class="inline-code">getSystemMessage</code></a> and the WebSocket server.</p>
</li>
<li><p><strong>Trace WebSocket Message Flow</strong>: Add logging to <code class="inline-code">WSMessage</code> handlers in the server to observe how different message types are processed. Analyze the flow of <code class="inline-code">text_delta</code> and <code class="inline-code">control</code> messages during a session.</p>
</li>
<li><p><strong>Enhance JSON Schema</strong>: Modify <a href="https://github.com/danwahlin/RealtimeAIApp-JS/blob/main/server/src/systemMessages.ts#L95" target="_blank" rel="noopener noreferrer"><code class="inline-code">getMedicalJSONSchema</code></a> to include additional medical data, such as allergies or medication history. Ensure the schema validation works correctly when the AI updates the patient data object.</p>
</li>
</ol>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the <em>Galactic Navigator</em>&#39;s systems.</p>
<p>Mission accomplished, star voyager‚Äîyour successful activation of the AI Personality Core shines brighter than a supernova; onward to the next cosmic challenge! ‚≠êüöÄ‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-1.html" class="prev-quest-btn">‚Üê Previous: Quest 1</a>
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>